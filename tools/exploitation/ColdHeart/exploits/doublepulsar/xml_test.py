import xml.etree.ElementTree as et

"""
Basic XML Config Structure

root
	group: inputparams

		timeout: param
		targetip: param
		port: param
		proto: choice
			smb
			rdp
		arch: choice
			x86
			x64
		function: choice
			output
			rundll
			...

	group2: outputparams - Dont Care
	group3: redirection - Dont Care

"""

tree = et.parse("Doublepulsar-1.3.1.0.xml")
root = tree.getroot()
group_ = root[0] # Only care about input params (root[0])

params = {}
for param in group_:
	if "choice" in param.tag:

		options = []
		for option in param:
			if len(option.attrib) == 0:
				pass
			else:
			#print("PARAM: {} OPTION: {}".format(param.attrib['name'], option.attrib['name']))
				#print(option.attrib['name'])
				options.append(option.attrib['name'])
		params[param.attrib['name']] = options
	else:
		#print("PARAM {}".format(param.attrib['name']))
		params[param.attrib['name']] = ''

print(params)
